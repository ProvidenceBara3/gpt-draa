<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPT-DRAA Monitoring Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/static/dashboard.css">
</head>
<body class="bg-gray-50 min-h-screen">
    <div class="min-h-screen flex" x-data="appController()">
        
        <!-- Sidebar Navigation -->
        <div class="fixed inset-y-0 left-0 z-50 w-64 bg-white shadow-lg border-r border-gray-200">
            <!-- Logo Header -->
            <div class="flex items-center justify-center h-16 px-4 border-b border-gray-200">
                <h1 class="text-xl font-bold text-gray-900">
                    <i class="fas fa-brain text-blue-600 mr-2"></i>
                    GPT-DRAA
                </h1>
            </div>

            <!-- Navigation Menu -->
            <nav class="mt-8 px-4">
                <div class="space-y-2">
                    <!-- Dashboard -->
                    <button 
                        @click="currentPage = 'dashboard'" 
                        :class="currentPage === 'dashboard' ? 'bg-blue-50 text-blue-700 border-r-2 border-blue-600' : 'text-gray-600 hover:bg-gray-50 hover:text-gray-900'"
                        class="group flex items-center px-3 py-3 text-sm font-medium rounded-l-md transition-colors w-full text-left"
                    >
                        <i class="fas fa-chart-line mr-3 text-lg w-5"></i>
                        Dashboard
                    </button>

                    <!-- AI Chat -->
                    <button 
                        @click="currentPage = 'chat'" 
                        :class="currentPage === 'chat' ? 'bg-blue-50 text-blue-700 border-r-2 border-blue-600' : 'text-gray-600 hover:bg-gray-50 hover:text-gray-900'"
                        class="group flex items-center px-3 py-3 text-sm font-medium rounded-l-md transition-colors w-full text-left"
                    >
                        <i class="fas fa-comments mr-3 text-lg w-5"></i>
                        AI Chat
                    </button>

                    <!-- Documents -->
                    <button 
                        @click="currentPage = 'documents'" 
                        :class="currentPage === 'documents' ? 'bg-blue-50 text-blue-700 border-r-2 border-blue-600' : 'text-gray-600 hover:bg-gray-50 hover:text-gray-900'"
                        class="group flex items-center px-3 py-3 text-sm font-medium rounded-l-md transition-colors w-full text-left"
                    >
                        <i class="fas fa-folder mr-3 text-lg w-5"></i>
                        Documents
                    </button>

                    <!-- Settings -->
                    <button 
                        @click="currentPage = 'settings'" 
                        :class="currentPage === 'settings' ? 'bg-blue-50 text-blue-700 border-r-2 border-blue-600' : 'text-gray-600 hover:bg-gray-50 hover:text-gray-900'"
                        class="group flex items-center px-3 py-3 text-sm font-medium rounded-l-md transition-colors w-full text-left"
                    >
                        <i class="fas fa-cog mr-3 text-lg w-5"></i>
                        Settings
                    </button>
                </div>
            </nav>

            <!-- Status Section -->
            <div class="absolute bottom-0 left-0 right-0 p-4 border-t border-gray-200">
                <!-- Model Status -->
                <div class="flex items-center justify-between mb-3">
                    <span class="text-xs font-medium text-gray-500">MODEL STATUS</span>
                    <div class="flex items-center space-x-2">
                        <div class="h-2 w-2 bg-green-400 rounded-full animate-pulse"></div>
                        <span class="text-xs text-green-600 font-medium">Online</span>
                    </div>
                </div>
                
                <!-- TinyLlama Info -->
                <div class="text-xs text-gray-500 mb-3">
                    <div class="flex items-center">
                        <i class="fas fa-robot mr-2"></i>
                        TinyLlama 1.1B
                    </div>
                    <div class="flex items-center mt-1">
                        <i class="fas fa-database mr-2"></i>
                        ChromaDB Active
                    </div>
                </div>

                <!-- Refresh Button -->
                <button 
                    @click="refreshData()" 
                    class="w-full bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded-md text-xs font-medium transition-colors flex items-center justify-center"
                >
                    <i class="fas fa-sync-alt mr-2"></i>Refresh Data
                </button>
            </div>
        </div>

        <!-- Main Content Area -->
        <div class="flex-1 ml-64 bg-gray-50 min-h-screen">
            <!-- Dashboard Page -->
            <div x-show="currentPage === 'dashboard'" x-data="dashboard()">
                <div class="p-8">
                    
                    <!-- Page Header -->
                    <div class="mb-8">
                        <h1 class="text-3xl font-bold text-gray-900">Dashboard</h1>
                        <p class="text-gray-600 mt-2">Monitor your GPT-DRAA system performance and analytics</p>
                    </div>
                    
                    <!-- Loading State -->
                    <div x-show="loading" class="flex items-center justify-center h-64">
                        <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"></div>
                        <span class="ml-3 text-gray-600">Loading dashboard data...</span>
                    </div>

                    <!-- Dashboard Content -->
                    <div x-show="!loading" x-cloak class="space-y-8">            <!-- Overview Cards -->
            <section id="overview" class="mb-8">
                <h2 class="text-2xl font-bold text-gray-900 mb-6">System Overview</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    
                    <!-- Total Queries Card -->
                    <div class="bg-white rounded-lg shadow-sm p-6 border border-gray-200">
                        <div class="flex items-center">
                            <div class="flex-shrink-0">
                                <div class="w-8 h-8 bg-blue-500 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-comments text-white text-sm"></i>
                                </div>
                            </div>
                            <div class="ml-5 w-0 flex-1">
                                <dl>
                                    <dt class="text-sm font-medium text-gray-500 truncate">Total Queries</dt>
                                    <dd class="text-3xl font-bold text-gray-900" x-text="stats.total_queries || '0'"></dd>
                                </dl>
                            </div>
                        </div>
                        <div class="mt-3">
                            <div class="flex items-center text-sm text-gray-600">
                                <span class="text-green-600 font-medium">+12% </span>
                                <span class="ml-1">vs last week</span>
                            </div>
                        </div>
                    </div>

                    <!-- Average Response Time Card -->
                    <div class="bg-white rounded-lg shadow-sm p-6 border border-gray-200">
                        <div class="flex items-center">
                            <div class="flex-shrink-0">
                                <div class="w-8 h-8 bg-yellow-500 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-clock text-white text-sm"></i>
                                </div>
                            </div>
                            <div class="ml-5 w-0 flex-1">
                                <dl>
                                    <dt class="text-sm font-medium text-gray-500 truncate">Avg Response Time</dt>
                                    <dd class="text-3xl font-bold text-gray-900">
                                        <span x-text="formatResponseTime(stats.last_day?.avg_response_time)"></span>
                                    </dd>
                                </dl>
                            </div>
                        </div>
                        <div class="mt-3">
                            <div class="flex items-center text-sm text-gray-600">
                                <span class="text-red-600 font-medium">+2.3s </span>
                                <span class="ml-1">vs last week</span>
                            </div>
                        </div>
                    </div>

                    <!-- Average Relevance Card -->
                    <div class="bg-white rounded-lg shadow-sm p-6 border border-gray-200">
                        <div class="flex items-center">
                            <div class="flex-shrink-0">
                                <div class="w-8 h-8 bg-green-500 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-bullseye text-white text-sm"></i>
                                </div>
                            </div>
                            <div class="ml-5 w-0 flex-1">
                                <dl>
                                    <dt class="text-sm font-medium text-gray-500 truncate">Avg Relevance Score</dt>
                                    <dd class="text-3xl font-bold text-gray-900">
                                        <span x-text="(stats.last_day?.avg_relevance || 0).toFixed(3)"></span>
                                    </dd>
                                </dl>
                            </div>
                        </div>
                        <div class="mt-3">
                            <div class="flex items-center text-sm text-gray-600">
                                <span class="text-green-600 font-medium">+0.008 </span>
                                <span class="ml-1">vs last week</span>
                            </div>
                        </div>
                    </div>

                    <!-- System Health Card -->
                    <div class="bg-white rounded-lg shadow-sm p-6 border border-gray-200">
                        <div class="flex items-center">
                            <div class="flex-shrink-0">
                                <div class="w-8 h-8 bg-purple-500 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-heart text-white text-sm"></i>
                                </div>
                            </div>
                            <div class="ml-5 w-0 flex-1">
                                <dl>
                                    <dt class="text-sm font-medium text-gray-500 truncate">System Health</dt>
                                    <dd class="text-3xl font-bold text-green-600">
                                        <span x-text="getSystemHealth()"></span>
                                    </dd>
                                </dl>
                            </div>
                        </div>
                        <div class="mt-3">
                            <div class="flex items-center text-sm text-gray-600">
                                <div class="h-2 w-2 bg-green-400 rounded-full mr-2"></div>
                                <span>All systems operational</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Embedding & Knowledge Base Section -->
            <section id="embeddings" class="mb-8">
                <h2 class="text-2xl font-bold text-gray-900 mb-6">Knowledge Base Status</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    
                    <!-- Total Documents -->
                    <div class="bg-white rounded-lg shadow-sm p-6 border border-gray-200">
                        <div class="flex items-center">
                            <div class="flex-shrink-0">
                                <div class="w-8 h-8 bg-indigo-500 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-file-alt text-white text-sm"></i>
                                </div>
                            </div>
                            <div class="ml-5 w-0 flex-1">
                                <dl>
                                    <dt class="text-sm font-medium text-gray-500 truncate">Documents Embedded</dt>
                                    <dd class="text-3xl font-bold text-gray-900" x-text="embeddingStats.totalDocuments || '2'"></dd>
                                </dl>
                            </div>
                        </div>
                        <div class="mt-3">
                            <div class="flex items-center text-sm text-gray-600">
                                <span class="text-green-600 font-medium">
                                    <i class="fas fa-check-circle mr-1"></i>Ready
                                </span>
                            </div>
                        </div>
                    </div>

                    <!-- Total Chunks -->
                    <div class="bg-white rounded-lg shadow-sm p-6 border border-gray-200">
                        <div class="flex items-center">
                            <div class="flex-shrink-0">
                                <div class="w-8 h-8 bg-teal-500 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-puzzle-piece text-white text-sm"></i>
                                </div>
                            </div>
                            <div class="ml-5 w-0 flex-1">
                                <dl>
                                    <dt class="text-sm font-medium text-gray-500 truncate">Text Chunks</dt>
                                    <dd class="text-3xl font-bold text-gray-900" x-text="embeddingStats.totalChunks || '42'"></dd>
                                </dl>
                            </div>
                        </div>
                        <div class="mt-3">
                            <div class="flex items-center text-sm text-gray-600">
                                <span class="text-blue-600 font-medium">
                                    <span x-text="embeddingStats.avgChunkSize || '512'"></span> avg tokens
                                </span>
                            </div>
                        </div>
                    </div>

                    <!-- Vector Database Status -->
                    <div class="bg-white rounded-lg shadow-sm p-6 border border-gray-200">
                        <div class="flex items-center">
                            <div class="flex-shrink-0">
                                <div class="w-8 h-8 bg-emerald-500 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-database text-white text-sm"></i>
                                </div>
                            </div>
                            <div class="ml-5 w-0 flex-1">
                                <dl>
                                    <dt class="text-sm font-medium text-gray-500 truncate">ChromaDB</dt>
                                    <dd class="text-3xl font-bold text-green-600">Active</dd>
                                </dl>
                            </div>
                        </div>
                        <div class="mt-3">
                            <div class="flex items-center text-sm text-gray-600">
                                <span class="text-gray-600">
                                    Last updated: <span x-text="embeddingStats.lastUpdated || 'Just now'"></span>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Performance Charts Section -->
            <section id="performance" class="mb-8">
                <h2 class="text-2xl font-bold text-gray-900 mb-6">Performance Metrics</h2>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    
                    <!-- Response Time Trend Chart -->
                    <div class="bg-white rounded-lg shadow-sm p-6 border border-gray-200">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-semibold text-gray-900">Response Time Trend</h3>
                            <div class="flex space-x-2">
                                <button class="text-sm text-blue-600 hover:text-blue-800">7d</button>
                                <button class="text-sm text-gray-400">30d</button>
                            </div>
                        </div>
                        <div class="h-64">
                            <canvas id="responseTimeChart"></canvas>
                        </div>
                    </div>

                    <!-- Relevance Score Distribution -->
                    <div class="bg-white rounded-lg shadow-sm p-6 border border-gray-200">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-semibold text-gray-900">Relevance Score Distribution</h3>
                            <div class="flex space-x-2">
                                <button class="text-sm text-blue-600 hover:text-blue-800">Today</button>
                                <button class="text-sm text-gray-400">Week</button>
                            </div>
                        </div>
                        <div class="h-64">
                            <canvas id="relevanceChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Language Usage and Query Analysis -->
            <section id="queries" class="mb-8">
                <h2 class="text-2xl font-bold text-gray-900 mb-6">Query Analysis</h2>
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    
                    <!-- Language Distribution -->
                    <div class="bg-white rounded-lg shadow-sm p-6 border border-gray-200">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">Language Distribution</h3>
                        <div class="space-y-4">
                            <template x-for="lang in stats.languages || []" :key="lang.language">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center">
                                        <div class="w-3 h-3 rounded-full mr-3" 
                                             :class="getLanguageColor(lang.language)"></div>
                                        <span class="text-sm font-medium text-gray-900" x-text="getLanguageName(lang.language)"></span>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="text-sm text-gray-600" x-text="lang.count"></span>
                                        <div class="w-20 bg-gray-200 rounded-full h-2">
                                            <div class="bg-blue-600 h-2 rounded-full" 
                                                 :style="`width: ${(lang.count / stats.total_queries * 100)}%`"></div>
                                        </div>
                                    </div>
                                </div>
                            </template>
                        </div>
                    </div>

                    <!-- Recent Queries -->
                    <div class="lg:col-span-2 bg-white rounded-lg shadow-sm p-6 border border-gray-200">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-semibold text-gray-900">Recent Queries</h3>
                            <button class="text-sm text-blue-600 hover:text-blue-800">View All</button>
                        </div>
                        <div class="space-y-3 max-h-64 overflow-y-auto">
                            <template x-for="query in recentQueries" :key="query.id">
                                <div class="flex items-start space-x-3 p-3 hover:bg-gray-50 rounded-lg">
                                    <div class="flex-shrink-0">
                                        <div class="w-2 h-2 rounded-full mt-2" 
                                             :class="query.avg_relevance > 0.05 ? 'bg-green-400' : 'bg-yellow-400'"></div>
                                    </div>
                                    <div class="flex-1 min-w-0">
                                        <p class="text-sm text-gray-900 truncate" x-text="query.query_text"></p>
                                        <div class="flex items-center space-x-4 mt-1 text-xs text-gray-500">
                                            <span x-text="query.language.toUpperCase()"></span>
                                            <span x-text="formatResponseTime(query.response_time_ms)"></span>
                                            <span x-text="'Relevance: ' + (query.avg_relevance || 0).toFixed(3)"></span>
                                            <span x-text="formatTime(query.timestamp)"></span>
                                        </div>
                                    </div>
                                </div>
                            </template>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Trends and Analytics -->
            <section id="trends" class="mb-8">
                <h2 class="text-2xl font-bold text-gray-900 mb-6">Trends & Analytics</h2>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    
                    <!-- Query Volume Trend -->
                    <div class="bg-white rounded-lg shadow-sm p-6 border border-gray-200">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">Query Volume Trend</h3>
                        <div class="h-64">
                            <canvas id="queryVolumeChart"></canvas>
                        </div>
                    </div>

                    <!-- Performance Score Card -->
                    <div class="bg-white rounded-lg shadow-sm p-6 border border-gray-200">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">Performance Score</h3>
                        <div class="text-center">
                            <div class="inline-flex items-center justify-center w-32 h-32 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full text-white mb-4">
                                <span class="text-3xl font-bold" x-text="getPerformanceGrade()"></span>
                            </div>
                            <p class="text-sm text-gray-600 mb-4">Overall System Performance</p>
                            <div class="grid grid-cols-3 gap-4 text-center">
                                <div>
                                    <div class="text-2xl font-bold text-blue-600" x-text="'85'"></div>
                                    <div class="text-xs text-gray-500">Speed</div>
                                </div>
                                <div>
                                    <div class="text-2xl font-bold text-green-600" x-text="'92'"></div>
                                    <div class="text-xs text-gray-500">Accuracy</div>
                                </div>
                                <div>
                                    <div class="text-2xl font-bold text-purple-600" x-text="'88'"></div>
                                    <div class="text-xs text-gray-500">Quality</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Low Performance Queries Alert -->
            <section class="mb-8" x-show="lowPerformanceQueries.length > 0">
                <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-6">
                    <div class="flex items-center mb-4">
                        <i class="fas fa-exclamation-triangle text-yellow-600 mr-2"></i>
                        <h3 class="text-lg font-semibold text-yellow-800">Attention: Low Performance Queries</h3>
                    </div>
                    <p class="text-sm text-yellow-700 mb-4">
                        The following queries had low relevance scores and may need attention:
                    </p>
                    <div class="space-y-2">
                        <template x-for="query in lowPerformanceQueries.slice(0, 3)" :key="query.id">
                            <div class="flex items-center justify-between bg-white p-3 rounded border border-yellow-200">
                                <span class="text-sm text-gray-900 truncate" x-text="query.query_text"></span>
                                <span class="text-sm text-yellow-600 font-medium" 
                                      x-text="'Score: ' + (query.avg_relevance || 0).toFixed(3)"></span>
                            </div>
                        </template>
                    </div>
                </div>
            </section>
        </div>
                </div>
            </div>

            <!-- AI Chat Page -->
            <div x-show="currentPage === 'chat'" x-data="chatInterface()">
                <div class="h-screen flex flex-col">
                    <!-- Chat Header -->
                    <div class="bg-white border-b border-gray-200 px-8 py-6">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-4">
                                <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl flex items-center justify-center">
                                    <i class="fas fa-robot text-white text-lg"></i>
                                </div>
                                <div>
                                    <h1 class="text-2xl font-bold text-gray-900">AI Assistant</h1>
                                    <p class="text-gray-600">Ask questions about digital inclusion in Africa</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-3 bg-green-50 px-4 py-2 rounded-lg border border-green-200">
                                <div class="h-3 w-3 bg-green-400 rounded-full animate-pulse"></div>
                                <span class="text-sm text-green-700 font-medium">TinyLlama Ready</span>
                            </div>
                        </div>
                    </div>

                    <!-- Chat Messages Area -->
                    <div class="flex-1 overflow-y-auto p-8 space-y-6 bg-gray-50">
                        <!-- Welcome Message -->
                        <div x-show="chatMessages.length === 0" class="text-center py-16">
                            <div class="w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-6">
                                <i class="fas fa-comments text-3xl text-blue-600"></i>
                            </div>
                            <h3 class="text-xl font-semibold text-gray-900 mb-3">Welcome to AI Chat</h3>
                            <p class="text-gray-600 max-w-md mx-auto">Ask me anything about digital inclusion, accessibility, or the documents in your knowledge base.</p>
                            <div class="mt-6 flex flex-wrap justify-center gap-3">
                                <button @click="currentMessage = 'What is digital inclusion?'; sendMessage()" class="px-4 py-2 bg-blue-100 text-blue-700 rounded-lg text-sm hover:bg-blue-200 transition-colors">
                                    What is digital inclusion?
                                </button>
                                <button @click="currentMessage = 'How can we improve accessibility in Africa?'; sendMessage()" class="px-4 py-2 bg-purple-100 text-purple-700 rounded-lg text-sm hover:bg-purple-200 transition-colors">
                                    Improve accessibility in Africa
                                </button>
                                <button @click="currentMessage = 'Tell me about assistive technologies'; sendMessage()" class="px-4 py-2 bg-green-100 text-green-700 rounded-lg text-sm hover:bg-green-200 transition-colors">
                                    Assistive technologies
                                </button>
                            </div>
                        </div>

                        <!-- Chat Messages -->
                        <template x-for="(message, index) in chatMessages" :key="index">
                            <div class="flex" :class="message.type === 'user' ? 'justify-end' : 'justify-start'">
                                <div class="max-w-3xl">
                                    <div class="flex items-start space-x-3" :class="message.type === 'user' ? 'flex-row-reverse space-x-reverse' : ''">
                                        <!-- Avatar -->
                                        <div class="w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0"
                                             :class="message.type === 'user' ? 'bg-blue-600' : 'bg-gray-600'">
                                            <i :class="message.type === 'user' ? 'fas fa-user text-white text-sm' : 'fas fa-robot text-white text-sm'"></i>
                                        </div>
                                        
                                        <!-- Message Bubble -->
                                        <div class="max-w-2xl">
                                            <div class="px-4 py-3 rounded-lg"
                                                 :class="message.type === 'user' ? 'bg-blue-600 text-white' : 'bg-white border border-gray-200'">
                                                <p class="text-sm whitespace-pre-wrap" x-text="message.content"></p>
                                            </div>
                                            
                                            <!-- Context Info for AI responses -->
                                            <div x-show="message.type === 'ai' && message.contextCount > 0" class="mt-2 text-xs text-gray-500">
                                                <i class="fas fa-search mr-1"></i>
                                                Found <span x-text="message.contextCount"></span> relevant context chunks
                                            </div>
                                            
                                            <!-- Timestamp -->
                                            <div class="mt-1 text-xs text-gray-500" x-text="formatTime(message.timestamp)"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </template>

                        <!-- Typing Indicator -->
                        <div x-show="isTyping" class="flex justify-start">
                            <div class="flex items-start space-x-3">
                                <div class="w-8 h-8 bg-gray-600 rounded-full flex items-center justify-center">
                                    <i class="fas fa-robot text-white text-sm"></i>
                                </div>
                                <div class="bg-white border border-gray-200 px-4 py-3 rounded-lg">
                                    <div class="flex space-x-1">
                                        <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce"></div>
                                        <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 0.1s"></div>
                                        <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Chat Input Area -->
                    <div class="bg-white border-t border-gray-200 p-6">
                        <div class="max-w-4xl mx-auto">
                            <div class="flex space-x-4">
                                <div class="flex-1">
                                    <textarea 
                                        x-model="currentMessage"
                                        @keydown.enter.prevent="currentMessage.trim() && sendMessage()"
                                        placeholder="Type your question here... (Press Enter to send)"
                                        class="w-full p-4 border border-gray-300 rounded-xl resize-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900 placeholder-gray-500"
                                        rows="3"
                                    ></textarea>
                                </div>
                                <button 
                                    @click="sendMessage()"
                                    :disabled="!currentMessage.trim() || isSending"
                                    class="px-8 py-4 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white font-medium rounded-xl transition-colors h-fit flex items-center"
                                >
                                    <span x-show="!isSending" class="flex items-center">
                                        <i class="fas fa-paper-plane mr-2"></i>Send
                                    </span>
                                    <span x-show="isSending" class="flex items-center">
                                        <i class="fas fa-spinner fa-spin mr-2"></i>Sending
                                    </span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Documents Page -->
            <div x-show="currentPage === 'documents'" x-data="documentManager()">
                <div class="p-8">
                    
                    <!-- Page Header -->
                    <div class="mb-8">
                        <h1 class="text-3xl font-bold text-gray-900">Document Management</h1>
                        <p class="text-gray-600 mt-2">Upload and manage documents for your AI knowledge base</p>
                    </div>

                    <div class="grid grid-cols-1 xl:grid-cols-2 gap-8">
                        <!-- Upload Section -->
                        <div class="space-y-6">
                            <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
                                <h3 class="text-xl font-semibold text-gray-900 mb-4">Upload New Documents</h3>
                                
                                <!-- Large Upload Area -->
                                <div 
                                    @dragover.prevent
                                    @drop.prevent="handleDrop($event)"
                                    @click="$refs.fileInput.click()"
                                    class="border-2 border-dashed border-gray-300 rounded-lg p-12 text-center cursor-pointer hover:border-blue-400 transition-colors mb-6"
                                    :class="isDragging ? 'border-blue-400 bg-blue-50' : ''"
                                    @dragenter.prevent="isDragging = true"
                                    @dragleave.prevent="isDragging = false"
                                >
                                    <div class="space-y-4">
                                        <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto">
                                            <i class="fas fa-cloud-upload-alt text-3xl text-gray-400"></i>
                                        </div>
                                        <div>
                                            <p class="text-xl font-medium text-gray-900">Drop files here or click to upload</p>
                                            <p class="text-gray-500 mt-2">Supports PDF, DOCX, TXT files up to 10MB each</p>
                                        </div>
                                    </div>
                                </div>
                                
                                <input 
                                    type="file" 
                                    x-ref="fileInput"
                                    @change="handleFileSelect($event)"
                                    multiple
                                    accept=".pdf,.docx,.txt"
                                    class="hidden"
                                >
                                
                                <!-- Selected Files -->
                                <div x-show="selectedFiles.length > 0" class="space-y-3 mb-6">
                                    <h4 class="font-medium text-gray-900">Selected Files:</h4>
                                    <template x-for="(file, index) in selectedFiles" :key="index">
                                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                            <div class="flex items-center space-x-3">
                                                <i class="fas fa-file text-blue-600 text-lg"></i>
                                                <div>
                                                    <p class="font-medium text-gray-900" x-text="file.name"></p>
                                                    <p class="text-sm text-gray-500" x-text="formatFileSize(file.size)"></p>
                                                </div>
                                            </div>
                                            <button @click="removeFile(index)" class="text-red-600 hover:text-red-800 p-2">
                                                <i class="fas fa-times"></i>
                                            </button>
                                        </div>
                                    </template>
                                </div>
                                
                                <!-- Upload Button -->
                                <button 
                                    @click="uploadFiles()"
                                    :disabled="selectedFiles.length === 0 || isUploading"
                                    class="w-full bg-green-600 hover:bg-green-700 disabled:bg-gray-400 text-white font-medium py-3 px-6 rounded-lg transition-colors text-lg"
                                >
                                    <span x-show="!isUploading">
                                        <i class="fas fa-upload mr-2"></i>Upload & Embed Documents
                                    </span>
                                    <span x-show="isUploading">
                                        <i class="fas fa-spinner fa-spin mr-2"></i>Processing Documents...
                                    </span>
                                </button>
                                
                                <!-- Progress Bar -->
                                <div x-show="isUploading" class="mt-4">
                                    <div class="w-full bg-gray-200 rounded-full h-3">
                                        <div class="bg-green-600 h-3 rounded-full transition-all duration-300" 
                                             :style="`width: ${uploadProgress}%`"></div>
                                    </div>
                                    <p class="text-sm text-gray-600 mt-2 text-center" x-text="`${uploadProgress}% complete`"></p>
                                </div>
                                
                                <!-- Upload Status -->
                                <div x-show="uploadStatus" class="mt-4 p-4 rounded-lg" 
                                     :class="uploadSuccess ? 'bg-green-50 text-green-800 border border-green-200' : 'bg-red-50 text-red-800 border border-red-200'">
                                    <p x-text="uploadStatus"></p>
                                </div>
                            </div>
                        </div>

                        <!-- Document Library Section -->
                        <div class="space-y-6">
                            <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
                                <div class="flex items-center justify-between mb-6">
                                    <h3 class="text-xl font-semibold text-gray-900">Document Library</h3>
                                    <button @click="loadDocuments()" class="text-blue-600 hover:text-blue-800 font-medium">
                                        <i class="fas fa-sync-alt mr-2"></i>Refresh
                                    </button>
                                </div>
                                
                                <!-- Document List -->
                                <div class="space-y-3 max-h-96 overflow-y-auto">
                                    <template x-for="doc in documents" :key="doc.id">
                                        <div class="flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors">
                                            <div class="flex items-center space-x-4 flex-1 min-w-0">
                                                <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center">
                                                    <i class="fas fa-file-alt text-blue-600"></i>
                                                </div>
                                                <div class="min-w-0 flex-1">
                                                    <p class="font-medium text-gray-900 truncate" x-text="doc.name"></p>
                                                    <p class="text-sm text-gray-500" x-text="'Uploaded: ' + formatDate(doc.uploaded_at)"></p>
                                                </div>
                                            </div>
                                            <div class="flex items-center space-x-3">
                                                <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                                    <i class="fas fa-check mr-1"></i>Embedded
                                                </span>
                                                <button @click="deleteDocument(doc.id)" class="text-red-600 hover:text-red-800 p-2">
                                                    <i class="fas fa-trash"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </template>
                                    
                                    <!-- Empty State -->
                                    <div x-show="documents.length === 0" class="text-center py-12">
                                        <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
                                            <i class="fas fa-folder-open text-3xl text-gray-400"></i>
                                        </div>
                                        <h4 class="text-lg font-medium text-gray-900 mb-2">No documents yet</h4>
                                        <p class="text-gray-500">Upload your first document to get started</p>
                                    </div>
                                </div>
                                
                                <!-- Document Stats -->
                                <div class="mt-6 pt-6 border-t border-gray-200">
                                    <div class="grid grid-cols-3 gap-4 text-center">
                                        <div>
                                            <p class="text-2xl font-bold text-blue-600" x-text="documents.length"></p>
                                            <p class="text-sm text-gray-500">Total Documents</p>
                                        </div>
                                        <div>
                                            <p class="text-2xl font-bold text-green-600" x-text="embeddedCount"></p>
                                            <p class="text-sm text-gray-500">Embedded</p>
                                        </div>
                                        <div>
                                            <p class="text-2xl font-bold text-purple-600" x-text="totalChunks"></p>
                                            <p class="text-sm text-gray-500">Text Chunks</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings Page -->
            <div x-show="currentPage === 'settings'" x-data="settingsManager()">
                <div class="p-8">
                    
                    <!-- Page Header -->
                    <div class="mb-8">
                        <h1 class="text-3xl font-bold text-gray-900">Settings</h1>
                        <p class="text-gray-600 mt-2">Configure your AI model and system preferences</p>
                    </div>

                    <div class="max-w-4xl space-y-8">
                        <!-- Model Configuration -->
                        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
                            <h3 class="text-xl font-semibold text-gray-900 mb-4">AI Model Configuration</h3>
                            
                            <div class="space-y-6">
                                <!-- Model Status -->
                                <div class="flex items-center justify-between p-4 bg-green-50 rounded-lg border border-green-200">
                                    <div class="flex items-center space-x-3">
                                        <div class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center">
                                            <i class="fas fa-check text-white text-sm"></i>
                                        </div>
                                        <div>
                                            <p class="font-medium text-green-900">TinyLlama Model Connected</p>
                                            <p class="text-sm text-green-700">tinyllama-1.1b-chat-v1.0 @ localhost:1234</p>
                                        </div>
                                    </div>
                                    <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800">
                                        Online
                                    </span>
                                </div>

                                <!-- ChromaDB Status -->
                                <div class="flex items-center justify-between p-4 bg-blue-50 rounded-lg border border-blue-200">
                                    <div class="flex items-center space-x-3">
                                        <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center">
                                            <i class="fas fa-database text-white text-sm"></i>
                                        </div>
                                        <div>
                                            <p class="font-medium text-blue-900">ChromaDB Connected</p>
                                            <p class="text-sm text-blue-700">Vector database for document embeddings</p>
                                        </div>
                                    </div>
                                    <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800">
                                        Active
                                    </span>
                                </div>

                                <!-- Model Settings -->
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Model Temperature</label>
                                        <input type="range" min="0" max="1" step="0.1" value="0.7" 
                                               class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                                        <div class="flex justify-between text-xs text-gray-500 mt-1">
                                            <span>Focused (0.0)</span>
                                            <span>Creative (1.0)</span>
                                        </div>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Max Response Length</label>
                                        <select class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                            <option value="512">Short (512 tokens)</option>
                                            <option value="1024" selected>Medium (1024 tokens)</option>
                                            <option value="2048">Long (2048 tokens)</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- System Preferences -->
                        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
                            <h3 class="text-xl font-semibold text-gray-900 mb-4">System Preferences</h3>
                            
                            <div class="space-y-4">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <p class="font-medium text-gray-900">Auto-refresh Dashboard</p>
                                        <p class="text-sm text-gray-500">Automatically refresh monitoring data every 30 seconds</p>
                                    </div>
                                    <button class="relative inline-flex h-6 w-11 items-center rounded-full bg-blue-600">
                                        <span class="translate-x-6 inline-block h-4 w-4 transform rounded-full bg-white transition"></span>
                                    </button>
                                </div>
                                
                                <div class="flex items-center justify-between">
                                    <div>
                                        <p class="font-medium text-gray-900">Enable Notifications</p>
                                        <p class="text-sm text-gray-500">Show notifications for system alerts and updates</p>
                                    </div>
                                    <button class="relative inline-flex h-6 w-11 items-center rounded-full bg-gray-200">
                                        <span class="translate-x-1 inline-block h-4 w-4 transform rounded-full bg-white transition"></span>
                                    </button>
                                </div>
                                
                                <div class="flex items-center justify-between">
                                    <div>
                                        <p class="font-medium text-gray-900">Dark Mode</p>
                                        <p class="text-sm text-gray-500">Switch to dark theme for better night viewing</p>
                                    </div>
                                    <button class="relative inline-flex h-6 w-11 items-center rounded-full bg-gray-200">
                                        <span class="translate-x-1 inline-block h-4 w-4 transform rounded-full bg-white transition"></span>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Data Management -->
                        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
                            <h3 class="text-xl font-semibold text-gray-900 mb-4">Data Management</h3>
                            
                            <div class="space-y-4">
                                <div class="flex items-center justify-between p-4 border border-gray-200 rounded-lg">
                                    <div>
                                        <p class="font-medium text-gray-900">Clear Chat History</p>
                                        <p class="text-sm text-gray-500">Remove all chat messages and conversations</p>
                                    </div>
                                    <button class="px-4 py-2 text-sm font-medium text-red-600 hover:text-red-800 border border-red-300 rounded-md hover:bg-red-50">
                                        Clear History
                                    </button>
                                </div>
                                
                                <div class="flex items-center justify-between p-4 border border-gray-200 rounded-lg">
                                    <div>
                                        <p class="font-medium text-gray-900">Reset Vector Database</p>
                                        <p class="text-sm text-gray-500">Clear all embedded documents and rebuild index</p>
                                    </div>
                                    <button class="px-4 py-2 text-sm font-medium text-red-600 hover:text-red-800 border border-red-300 rounded-md hover:bg-red-50">
                                        Reset Database
                                    </button>
                                </div>
                                
                                <div class="flex items-center justify-between p-4 border border-gray-200 rounded-lg">
                                    <div>
                                        <p class="font-medium text-gray-900">Export System Data</p>
                                        <p class="text-sm text-gray-500">Download monitoring data and analytics reports</p>
                                    </div>
                                    <button class="px-4 py-2 text-sm font-medium text-blue-600 hover:text-blue-800 border border-blue-300 rounded-md hover:bg-blue-50">
                                        Export Data
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    <script src="/static/dashboard.js"></script>
</body>
</html>
